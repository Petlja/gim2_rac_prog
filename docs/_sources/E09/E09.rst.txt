Више табела у истом документу
==============================

У овој лекцији ћемо показати како се у Ексел документу може радити са више табела (радних листова). Конкретно, показаћемо:

1. креирање и промену имена радног листа,
2. унос података у радне листове и копирање садржаја са једног радног листа на други, и
3. преузимање података са другог радног листа.

Пример: Зарада по пословним јединицама
---------------------------------------


Са следећег линка преузми документ *PoslJedinice.xlsx*


`PoslJedinice.xlsx <https://petljamediastorage.blob.core.windows.net/root/Media/Default/Kursevi/programiranje_II/epodaci/PoslJedinice.xlsx>`_

и отвори га у Екселу:


.. image:: ../../_images/PJ1.jpg
   :width: 600px
   :align: center


Документ на дну има два "језичка". Ови "језичци" се на енглеском језику зову "табови" (*tabs*). Сваки од њих представља по један радни лист на коме ћемо креирати своје табеле. Тренутно видимо радни лист "Cene", а ако желимо да видимо радни лист "PJ1" (од "Пословна Јединица 1") који је испод, треба да кликнемо на таб "PJ1":


.. image:: ../../_images/PJ2.jpg
   :width: 600px
   :align: center


Вратимо се на таб "Cene":


.. image:: ../../_images/PJ3.jpg
   :width: 600px
   :align: center


Овај документ треба да садржи преглед пословања једне мале фирме која продаје одећу и има три пословне јединице. Документу ћемо додати још три радна листа који ће се звати овако:

* "PJ2" ("Пословна Јединица 2"),
* "PJ3" ("Пословна Јединица 3"), и
* "Pregled".



Додавање и брисање радних листова, промена имена и редоследа
-------------------------------------------------------------


**Корак 1.** Да бисмо додали нови радни лист треба да кликнемо на мали знак :math:`\oplus` који се налази поред табова ("додај нови радни лист"). Добијамо:


.. image:: ../../_images/PJ4.jpg
   :width: 600px
   :align: center


Ексел је уметнуо нови радни лист *непосредно иза* радног листа који је био активан и дао му је име "Sheet1", јер се радни листови на енглеском зову *work sheets*.

**Корак 2.** Променићемо име новог радног листа у "PJ2" тако што ћемо кликнути *десним* тастером миша на таб "Sheet1" и из менија који се појави одабрати "Rename":


.. image:: ../../_images/PJ5.jpg
   :width: 600px
   :align: center


(Ако желимо да обришемо радни лист који смо грешком додали, из горњег менија треба одабрати "Delete".)

Онда ћемо укуцати ново име радног листа, "PJ2" у нашем случају:


.. image:: ../../_images/PJ6.jpg
   :width: 600px
   :align: center


и притиснути [ENTER].

**Корак 3.** Редослед је погрешан јер се "PJ2" јавља пре "PJ1". Да бисмо то исправили "ухватићемо" мишем таб "PJ2" и *не пуштајући тастер* превући га десно од "PJ1":


.. image:: ../../_images/PJ7.jpg
   :width: 600px
   :align: center


Када отпустимо тастер, таб се налази на свом месту:


.. image:: ../../_images/PJ8.jpg
   :width: 600px
   :align: center


**Корак 4.** За крај овог дела додаћемо још два радна листа, "PJ3" и "Pregled":


.. image:: ../../_images/PJ9.jpg
   :width: 600px
   :align: center


Унос података у радне листове и копирање садржаја са једног радног листа на други
----------------------------------------------------------------------------------


**Корак 5.** Врати се на радни лист "Cene" да га мало улепшаш:

- мало прошири колону А
- спој ћелије A1 и B1 (опција "Merge Cells") и повећај величину слова на 16


.. image:: ../../_images/PJ10.jpg
   :width: 600px
   :align: center


- унеси произвољне цене производа:


.. image:: ../../_images/PJ11.jpg
   :width: 600px
   :align: center


**Корак 6.** Пређи на радни лист "PJ1" да њега мало улепшаш:

- мало прошири колоне А, B и C
- спој ћелије A1:C1 (опција "Merge Cells") и повећај величину слова на 16
- унеси произвољне бројеве у колону "Prodato kom."


.. image:: ../../_images/PJ12.jpg
   :width: 600px
   :align: center


**Корак 7.** Пређи на радни лист "PJ2". Он је потпуно празан:


.. image:: ../../_images/PJ31.jpg
   :width: 600px
   :align: center


Да не бисмо из почетка прекуцавали имена колона и имена производа ископираћемо их са радног листа "PJ1".

**Корак 8.** Врати се на радни лист "PJ1" и селектуј све на њему:


.. image:: ../../_images/PJ32.jpg
   :width: 600px
   :align: center


Онда у групи команди "Clipboard" кликни на опцију "Copy":


.. image:: ../../_images/PJ15.jpg
   :width: 600px
   :align: center


У табели се не види никаква промена (јер ништа нисмо ни мењали); опција "Copy" је у посебан део меморије прекопирала садржај ћелија A1:C8.

**Корак 9.** Сада се врати на радни лист "PJ2" и кликни на ћелију А1:


.. image:: ../../_images/PJ33.jpg
   :width: 600px
   :align: center


и онда из групе команди "Clipboard" одабери опцију "Paste":


.. image:: ../../_images/PJ17.jpg
   :width: 600px
   :align: center


Ексел је ископирао податке из меморије на нову локацију тако да горњи десни угао нове табеле буде ћелија на коју смо кликнули на почетку (А1):


.. image:: ../../_images/PJ34.jpg
   :width: 600px
   :align: center


**Корак 10.** Кликни на наслов табеле (ћелије А1:C1) и притисни тастер [F2] како би прешао у мод за исправке:


.. image:: ../../_images/PJ35.jpg
   :width: 600px
   :align: center


и исправи "Poslovna jedinica 1" на "Poslovna jedinica 2" и притисни [ENTER]:


.. image:: ../../_images/PJ36.jpg
   :width: 600px
   :align: center


**Корак 11.** Селектуј ћелије B3:B8


.. image:: ../../_images/PJ37.jpg
   :width: 600px
   :align: center


и притисни тастер [Del] како бисмо обрисали податке:


.. image:: ../../_images/PJ38.jpg
   :width: 600px
   :align: center


**Корак 12.** За крај рада на радном листу "PJ2":

- мало прошири колоне А, B и C
- унеси произвољне бројеве у колону "Prodato kom."


.. image:: ../../_images/PJ21.jpg
   :width: 600px
   :align: center


**Корак 13.** На исти начин попуни радни лист "PJ3":


.. image:: ../../_images/PJ39.jpg
   :width: 600px
   :align: center


**Корак 14.** Радни лист "Pregled" има другачију структуру јер је на њему сажет преглед зарада по пословним јединицама. Попуни га овако:


.. image:: ../../_images/PJ40.jpg
   :width: 600px
   :align: center



Преузимање података са другог радног листа
-------------------------------------------


Сада ћемо, на основу података које смо унели у табелу, израчунати колико је зарадила свака од пословница. Да се подсетимо, радни лист "Cene" представља ценовник, на њему не треба ништа рачунати.

**Корак 15.** Пређимо на радни лист "PJ1" како бисмо израчунали колико је Пословна јединица 1 зарадила. У ћелији C3


.. image:: ../../_images/PJ41.jpg
   :width: 600px
   :align: center


треба да израчунамо колико је новца зарађено продајом мајица у тој пословној јединици. Податак о броју продатих мајица је дат на радном листу "PJ1", док је цена једне мајице дата на радном листу "Cene". У ћелију C3 треба да унесемо формулу:
::

    = (цена мајице са радног листа "Cene") * B3


Податак о цени једне мајице се налази на радном листу "Cene" у ћелији B3. До тог податка можемо доћи помоћу израза ``Cene!B3``
што значи: *ћелија B3 са радног листа "Cene"*. Дакле, у ћелију C3 треба да унесемо формулу:
::

    = Cene!B3 * B3



.. image:: ../../_images/PJ42.jpg
   :width: 600px
   :align: center


Добијамо:


.. image:: ../../_images/PJ43.jpg
   :width: 600px
   :align: center


**Корак 16.** Пошто у ћелије испод ћелије C3 треба да унесемо сличне формуле, кликнућемо на ћелију C3 и "развући" је до краја табеле:


.. image:: ../../_images/PJ44.jpg
   :width: 600px
   :align: center


Ексел је, као и до сада, интелигентно ископирао формуле, што можемо лако проверити:


.. image:: ../../_images/PJ45.jpg
   :width: 600px
   :align: center


**Корак 17.** Зараду Пословних јединица 2 и 3 ћемо још брже израчунати. На радном листу "PJ1" ћемо селектовати ћелије C3:C8


.. image:: ../../_images/PJ46.jpg
   :width: 600px
   :align: center


па ћемо кликнути на опцију "Copy":


.. image:: ../../_images/PJ47.jpg
   :width: 600px
   :align: center


Онда ћемо прећи на радни лист "PJ2", кликнути на ћелију C3 и одабрати опцију "Paste":


.. image:: ../../_images/PJ48.jpg
   :width: 600px
   :align: center


па ћемо прећи на радни лист "PJ3", кликнути на ћелију C3 и поново одабрати опцију "Paste":


.. image:: ../../_images/PJ49.jpg
   :width: 600px
   :align: center


Лако се види да је Ексел у сваком од ових случајева ископирао формуле тачно онако како смо и очекивали.
**Корак 18.** Сада ћемо попунити радни лист "Pregled" на коме се налази преглед укупне зараде.


.. image:: ../../_images/PJ50.jpg
   :width: 600px
   :align: center


У ћелију B3 радног листа "Pregled" треба да упишемо зараду Пословне јединице 1, што је збир ћелија C3:C8 са радног листа "PJ1". Зато ћемо у ћелију B3 унети следећу формулу:
::

    =SUM(PJ1!C3:C8)



.. image:: ../../_images/PJ51.jpg
   :width: 600px
   :align: center


Израз ``PJ1!C3:C8`` значи: "са радног листа PJ1 опсег C3:C8".

Зато израз ``SUM(PJ1!C3:C8)`` значи: "са радног листа PJ1 опсег C3:C8, па сума свега тога".

**Корак 18.** На исти начин попунимо ћелије B4 и B5 које садрже зараду Пословних јединица 2 и 3 тако што, редом, унесемо формуле
::

    =SUM(PJ2!C3:C8)
    =SUM(PJ3!C3:C8)



.. image:: ../../_images/PJ52.jpg
   :width: 600px
   :align: center


*ПАЖЊА! Овде не смемо да "развучемо формулу" из ћелије B3 већ треба ручно да унесемо још две формуле!* (Шта мислиш зашто?)

Да бисмо завршили рачун на овом радном листу у ћелију B6 ћемо унети укупну зараду из све три пословне јединице:


.. image:: ../../_images/PJ53.jpg
   :width: 600px
   :align: center


**Корак 19.** За крај ћемо секторским дијаграмом приказати удео сваке од ове три пословне јединице у укупној заради фирме.

Селектоваћемо ћелије A2:B5 (*имена колона обавезно укључујемо у селекцију!*), прећи на командну траку "Insert" и из групе команди "Charts" одабрати опцију која креира секторске дијаграме:


.. image:: ../../_images/PJ54.jpg
   :width: 600px
   :align: center


Добијамо дијаграм:


.. image:: ../../_images/PJ55.jpg
   :width: 600px
   :align: center


Са овог дијаграма се лако види да је у ситуацији која је описана овом табелом Пословна јединица 3 зарадила више него Пословне јединице 1 и 2 заједно.

Задаци
-------


**Задатак 1.** У наредних неколико корака направићемо Електронски дневник.

*Корак 1.* Кренути од празног Ексел документа па у њему креирати следеће радне листове:

* Učenici
* Matematika
* Srpski
* Engleski
* Informatika

Радни лист "Učenici" треба да садржи следеће колоне: "Prezime i ime", "Prosečna ocena". Потом унети податке о неколико ученика, али само презиме и име, *не* и просечну оцену.

Сваки од преосталих раних листова треба да садржи следеће колоне: "Prezime i ime", "Ocena"

*Корак 2.* Списак ученика са радног листа "Učenici" ископирати на све остале радне листове.

*Корак 3.* На сваком од радних листова "Matematika", "Srpski", "Engleski", "Informatika" за сваког ученика унети по једну оцену.

*Корак 4.* На радном листу "Učenici" израчунати просечну оцену сваког ученика. Напомена: Функција AVERAGE овде не помаже, већ се оцена, рецимо за првог ученика, мора рачунати по формули као што је ова:
::

    = (Matematika!B2 + Srpski!B2 + Engleski!B2 + Informatika!B2)/4


Срећом, ради брзо копирање формула! (Зашто?)

**Задатак 2.** Једна компанија се специјализовала за држање курсева из програмирања. Њихов бизнис-план можеш преузети са следећег линка:


`Kursevi.xlsx <https://petljamediastorage.blob.core.windows.net/root/Media/Default/Kursevi/programiranje_II/epodaci/Kursevi.xlsx>`_

На радном листу *Ponuda* дат је списак курсева који се држе, као и цена сваког курса по полазнику. Такође је дата и цена издавања сертификата о положеном курсу. Сви полазници морају да плате цену курса, али само полазници који су положили испит плаћају цену издавања сертификата.

На радном листу *Polaznici* налази се табела из које се види да је сваки курс одржан три пута, за три групе полазника. Попуни податке о броју полазника у овој табели произвољним вредностима.

На радном листу *Ispit* за сваки курс треба израчунати колико полазника је укупно похађало тај курс, а потом унети број полазника који су положили испит. (Као број полазника који су положили испит из неког курса можеш унети произвољну вредност, али она *не сме да премаши* укупан број полазника који су похађали курс.)

На радном листу *Zarada* израчунај колико новца је зарадио сваки курс
