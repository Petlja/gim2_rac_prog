Селектовање групе ћелија и уређивање табеле
============================================

Теме за овај час:

1. уношење формула и брзо копирање (подсећање и мала новина),
2. селектовање групе ћелија,
3. приказивање бројева са датим бројем децимала,
4. промена боје ћелије, као и боје и стила текста.

Пример: Летњи месеци
---------------------

У табели испод су дате очекиване температуре у степенима Целзијуса у неким европским градовима у мају, јуну, јулу и августу једне
године. Прерачунаћемо те податке у степене Фаренхајта, за сваки град одредити просек за четири наведена месеца,
и одредићемо најтоплије и најхладније градове по месецима.

**Корак 1.** Преузми табелу са следећег линка `LetnjiMeseci.xlsx <https://petljamediastorage.blob.core.windows.net/root/Media/Default/Kursevi/programiranje_II/epodaci/LetnjiMeseci.xlsx>`_ тако што ћеш кликнути на
линк *десним тастером миша* и онда у малом менију који се појави одабрати опцију "Save link as...".
Када отвориш табелу из Ексела треба да видиш следеће податке:

.. image:: ../../_images/DataTypes1.jpg
   :width: 600px
   :align: center

Уношење формула и брзо копирање
--------------------------------

**Корак 2.** У ћелију F2 унеси формулу
::

    =AVERAGE(B2:E2)


која ће израчунати просечну температуру за ова четири месеца у Амстердаму:


.. image:: ../../_images/DataTypes2.jpg
   :width: 600px
   :align: center


и притисни [ENTER]:


.. image:: ../../_images/DataTypes3.jpg
   :width: 600px
   :align: center


**Корак 3.** Сада ћемо у ћелију G2 да унесемо формулу која ће прерачунати температуру у мају у Амстердаму из степена Целзијуса у степене Фаренхајта по формули


.. math::
     t_F = 1,8 \cdot t_C + 32


Приликом уношења формуле морамо повести рачуна о томе да се множење означава звездицом ``*``:


.. image:: ../../_images/DataTypes4.jpg
   :width: 600px
   :align: center


**Корак 4.** Исти посао треба урадити за јун, јул, август и за просек. Можемо исту формулу унети још четири пута, али је боље да се послужимо брзим копирањем. Ако кликнемо на ћелију G2 видећемо увек присутну "бубуљицу" у доњем десном углу:


.. image:: ../../_images/DataTypes5.jpg
   :width: 600px
   :align: center


Ухватимо "бубуљицу", развучемо до краја врсте и добијамо:


.. image:: ../../_images/DataTypes6.jpg
   :width: 600px
   :align: center


Формула у ћелији G2 је гласила
::

   = 1.8 * B2 + 32

Ако погледамо шта пише у ћелији H2 видећемо да тамо стоји формула
::

   = 1.8 * C2 + 32

Као и раније, на основу формуле која је била уписана у ћелију G2 Ексел је простим алгоритмом генерисао формуле и уписао их редом у све ћелије кроз које смо "развукли оквир". Међутим, пошто смо овај пут "оквир развукли" хоризонтално Ексел је применио други алгоритам: сада се слова у адреси ћелије редом повећавају, а бројеви у адреси ћелије се не мењају. Ево и табеларног прегледа:

.. csv-table:: Формуле у одговарајућим ћелијама табеле
   :header: "Ћелија", "Формула"
   :align: left

   "G2", "= 1.8 * B2 + 32"
   "H2", "= 1.8 * C2 + 32"
   "I2", "= 1.8 * D2 + 32"
   "J2", "= 1.8 * E2 + 32"
   "K2", "= 1.8 * F2 + 32"

Дакле, брзо копрање ради на један начин када оквир "развлачимо" вертикално, а на други начин када га "развлачимо" хоризонтално. Поента је да се у сваком случају "чува логика формуле".

Селектовање групе ћелија
-------------------------


До сада смо попунили тек први ред табеле. Уместо да све ове кораке понављамо за сваки ред табеле посебно, послужићемо се још једним лукавством. Означићемо низ ћелија (ова операција се у жаргону зове "селектовање" од енгл. *select* што значи "одабрати") и онда ћемо брзим копирањем попунити све ћелије у табели.

**Корак 5.** Пошто смо попунили први ред табеле, означићемо (такорећи *селектоваћемо*) низ ћелија F2:K2 тако што ћемо кликнути на ћелију F2 (дакле, НЕ на "бубуљицу" већ у срце ћелије F2) и *не пуштајући миша* развући оквир до ћелије K2:


.. image:: ../../_images/DataTypes7.jpg
   :width: 600px
   :align: center


Овим смо означили ћелије које су интересантне (јер садрже формуле које желимо да размножимо по целој табели).

**Корак 6.** Е, *сада ухватимо за "бубуљицу"* која се налази у доњем десном углу означеног распона и "развучемо" до дна табеле:


.. image:: ../../_images/DataTypes8.jpg
   :width: 600px
   :align: center


Ексел је ископирао формуле које су се налазиле у означеним ћелијама и током копирања сваку формулу прилагодио позицији на којој се она налази. На пример, ако погледамо ћелију J11 (температура у степенима Фаренхајта у Ослу у августу) видећемо да је та вредност израчуната тако што је формула за конверзију примењена на ћелију E11 (температура у степенима Целзијуса у Ослу у августу), као што и треба:


.. image:: ../../_images/DataTypes9.jpg
   :width: 600px
   :align: center


Тако је овај део задатка решен.

Форматирање децималних бројева
-------------------------------

**Корак 7.** У табели сада има много децималних бројева. Неки немају децимале, неки имају само једну децималу, а неки две и табела изгледа доста неуредно.

Да би табела са много бројева (а такве су најчешће када се ради са Екселом) била прегледнија обично се Екселу наложи да бројеве са децималама приказује са унапред задатим бројем децимала, рецимо две. У том случају ће број као што је 42 бити приказан као 42.00, број 21.5 као 21.50, а број 3.1415 као 3.14.

За подешавање приказа бројева у табели користимо групу команди "Number":


.. image:: ../../_images/DataTypes-N.jpg
   :width: 600px
   :align: center


Да бисмо објаснили Екселу у ком делу табеле бројеве треба приказати са задатим бројем децимала, селектоваћемо део табеле као у претходном кораку, с тим да ће овај пут селектовани део табеле имати више врста и колона.

Кликни мишем на ћелију F2 *и не пуштајући леви тастер на мишу* развуци оквир до ћелије K16 овако:


.. image:: ../../_images/DataTypes10.jpg
   :width: 600px
   :align: center


Кликни на стрелицу поред "General" и у менију који се појави одабери "Number":


.. image:: ../../_images/DataTypes11.jpg
   :width: 600px
   :align: center


Сви бројеви у селектованом делу табеле ће бити приказани са две децимале.


.. image:: ../../_images/DataTypes12.jpg
   :width: 600px
   :align: center


Приказивање бројева са две децимале је најчешћи захтев који корисници Ексела имају, и зато је подразумевано да ће Ексел приказати бројеве на две децимале. Ако из неких разлога желимо да прикажемо бројеве са три децимална места, или само једним, треба кликнути на стрелицу поред "General", па уместо "Number" одабрати "More Number Formats..." ("још формата бројева"):


.. image:: ../../_images/DataTypes13.jpg
   :width: 600px
   :align: center


и у прозору који се појавио унети жељени број децимала:


.. image:: ../../_images/DataTypes14.jpg
   :width: 600px
   :align: center


Рачунање минимума и максимума
------------------------------


**Корак 8.** Сада ћемо научити како да одредимо најхладнији и најтоплији град по месецима. У ћелију А17 упиши "Minimum", а у ћелију A18 упиши "Maksimum":


.. image:: ../../_images/DataTypes15.jpg
   :width: 600px
   :align: center


**Корак 9.** У ћелију B17 упиши следећу формулу:
::

    = MIN(B2:B16)


Ова формула ће израчунати најмањи (MIN) од бројева B2, B3, ..., B16 (B2:B16) и ту вредност уписати у ћелију B17:


.. image:: ../../_images/DataTypes16.jpg
   :width: 600px
   :align: center


**Корак 10.** Онда у ћелију B18 упиши формулу:
::

    = MAX(B2:B16)


Ова формула ће израчунати највећи (MAX) од бројева B2, B3, ..., B16 (B2:B16) и ту вредност уписати у ћелију B18:


.. image:: ../../_images/DataTypes17.jpg
   :width: 600px
   :align: center


Тако смо добили најнижу и највижу температуру у мају:


.. image:: ../../_images/DataTypes18.jpg
   :width: 600px
   :align: center


**Корак 11.** Да бисмо то исто урадили за јун, јул и август полсужићемо се комбинацијом трикова које смо научили -- селектоваћемо ћелије B17 и B18:


.. image:: ../../_images/DataTypes19.jpg
   :width: 600px
   :align: center


па ћемо "ухватити за бубуљицу" и развући селекцију до колоне Е:


.. image:: ../../_images/DataTypes20.jpg
   :width: 600px
   :align: center


Тако смо добили најниже и највише температуре које су постигнуте у ова четири месеца:


.. image:: ../../_images/DataTypes21.jpg
   :width: 600px
   :align: center



Уређивање табеле
-----------------


Табела сада садржи све податке које смо желели у њу да спакујемо, али је доста непрегледна. Ми, људи, нисмо добри у тумачењу велике количине бројева -- много боље нам иду слике. Зато ћемо мало улепшати табелу како бисмо истакли оно што смо уочили и како бисмо раздвојили различите врсте података.

За истицање елемената у табели користимо сегмент команди које се налазе у групи "Font":


.. image:: ../../_images/DataTypes22.jpg
   :width: 600px
   :align: center


Команде представљене иконама у овој групи већ познајеш:


.. image:: ../../_images/DataTypes23.jpg
   :width: 600px
   :align: center

**Корак 12.** Постави боју слова у заглављу табеле (ћелије А1:К1) на бело, а боју позадине ћелија на тамно сиво тако што ћеш

1. селектовати ћелије А1:К1
2. кликнути на стрелицу поред иконе за подешавање боје слова и одабрати белу боју, и
3. кликнути на стрелицу поред иконе за подешавање боје позадине ћелије и одабрати тамно сиву.


.. image:: ../../_images/DataTypes24.jpg
   :width: 600px
   :align: center


**Корак 13.** За слова у ћелијама А17:Е18 (минималне и максималне температуре):

1. као стил одабери **B** (енгл. *bold* што значи "подебљано"),
2. зеленом обој слова која одговарају минималним температурама, а
3. црвеном обој слова која одговарају максималним температурама.


.. image:: ../../_images/DataTypes25.jpg
   :width: 600px
   :align: center


**Корак 14.** Позадину ћелија које одговарају просечним температурама (F2:F16 и K2:K16) обој жуто:


.. image:: ../../_images/DataTypes26.jpg
   :width: 600px
   :align: center


**Корак 15.** Температуре које су исказане у степенима Фаренхајта (ћелије G2:J16) обој светло плаво:


.. image:: ../../_images/DataTypes27.jpg
   :width: 600px
   :align: center


**Корак 16.** Коначно, у делу табеле B2:E16 где су температуре исказане у степенима Целзијуса

1. обој светло зелено позадину сваке ћелије која садржи температуру која је минимална за тај месец, и
2. обој светло црвено позадину сваке ћелије која садржи температуру која је максимална за тај месец.

Треба да добијеш:


.. image:: ../../_images/DataTypes28.jpg
   :width: 600px
   :align: center


Шта закљућујеш гледајући само у боје ћелија?

Задаци
-------


**Задатак 1.** Са следећег линка `Razred.xlsx <https://petljamediastorage.blob.core.windows.net/root/Media/Default/Kursevi/programiranje_II/epodaci/Razred.xlsx>`_ преузми документ *Razred.xlsx* и сними га на свој рачунар.
Документ садржи податке о оценама из информатике неких ученика. 

1. Колоне "P1" "P2" и "P3" садрже оцене са првог, другог и трећег писменог задатка. У ћелијама E19, J19, M19 израчунај просечну оцену одговарајућег писменог задатка.
2. Прикажи просек оцена на две децимале. Прошири колоне да би се виделе децимале.
3. У колонама "P1" "P2" и "P3" обој слова црвеном и постави стил на **bold**.
4. За сваког ученика у колони "Prosek" израчунај просек његових оцена и прикажи просек на две децимале.
5. У колони "Zaokruženo" заокружи оцену сваког ученика на цео броj користећи функцију ``ROUND``. На пример, за првог ученика у ћелију Q2 унеси формулу ``=ROUND(P2,0)`` која број из ћелије "P2" заокружује на 0 децимала (дакле, на цео број). Онда "развуци" формулу до краја табеле. Прошири колону ако је потребно.
6. У колони "Maks ocena" за сваког ученика израчунај максималну оцену која је том ученику уписана у дневник.
7. Позадину ћелија у колони "Zaokruženo" обој плавом, а позадину ћелија у колони "Maks ocena" наранџастом.
8. Сними табелу.

**Задатак 2.** Ученици једног разреда су скакали у даљ. Сваки ученик је имао три покуашаја. У случају преступа податак није унет у табелу.
Са следећег линка `SkokUDalj.xlsx <https://petljamediastorage.blob.core.windows.net/root/Media/Default/Kursevi/programiranje_II/epodaci/SkokUDalj.xlsx>`_ преузми документ *SkokUDalj.xlsx* и сними га на свој рачунар.

1. Прошири колоне ако је потребно да би се садржај лепо видео.
2. За сваког ученика у табели израчунај просечну дужину његових покушаја.
3. За сваког ученика у табели израчунај дужину његовог најдужег скока.
4. Црвеном обој име сваког ученика који је начинио бар један преступ.
5. Нека стил слова у колони која садржи просечну дужину скока буде *italic*.
6. Нека стил слова у колони која садржи максималну дужину скока буде **bold**.
7. Сними табелу.
